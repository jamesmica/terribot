distance = NULL,
depart_at = NULL,
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
rate_limit = 300,
keep_color_cols = FALSE,
id_column = NULL
)
iso<-mapboxapi::mb_isochrone(loc,
profile = "driving",
time = c(5, 10, 15),
distance = NULL,
depart_at = NULL,
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
rate_limit = 300,
keep_color_cols = FALSE,
id_column = NULL
)
iso<-mapboxapi::mb_isochrone(loc[1:5,],
profile = "driving",
time = c(5, 10, 15),
distance = NULL,
depart_at = NULL,
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
rate_limit = 300,
keep_color_cols = FALSE,
id_column = NULL
)
iso<-mapboxapi::mb_isochrone(location = loc[,c(2,1)],
profile = "driving",
time = c(5, 10, 15),
distance = NULL,
depart_at = NULL,
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
rate_limit = 300,
keep_color_cols = FALSE,
id_column = NULL
)
iso<-mapboxapi::mb_isochrone(location = loc,
profile = "driving",
time = c(5, 10, 15),
distance = NULL,
depart_at = NULL,
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
rate_limit = 300,
keep_color_cols = FALSE,
id_column = NULL
)
loc<- read.csv("C:/Profil 2023/BDD/bpe21matprim2.csv")
loc <- loc[,c(6,5,4)]
iso<-mapboxapi::mb_isochrone(location = loc,
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
lat<-loc$lat
lon<-loc$lon
iso<-mapboxapi::mb_isochrone(location = c(lat,lon),
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
iso<-mapboxapi::mb_isochrone(location = c(lon,lat),
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
locc<-loc$lat
locc<-loc$lat
locc$longitude<-loc$lat
locc$latitude<-loc$lon
data.frame(locc)
locc<-data.frame(locc)
gc()
locc<-data.frame(locc)
locc<-as.data.frame(1)
locc$longitude<-loc$lat
loc<- read.csv("C:/Profil 2023/BDD/bpe21matprim2.csv")
locc$longitude<-loc$lat
loc$longitude<-loc$lat
loc$latitude<-loc$lon
loc<-loc[,c(7,8)]
iso<-mapboxapi::mb_isochrone(loc,
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
iso<-mapboxapi::mb_isochrone(c(1.84,49.1),
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
plot(iso)
mapdeck(style = mapdeck_style("light")) %>%
add_polygon(
data = iso,
fill_colour = "time",
fill_opacity = 0.5,
legend = TRUE
)
dt<-list(c(1.84,49.1),c(1.83,49.2),c(1.84,49.1))
iso<-mapboxapi::mb_isochrone(dt,
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
dt<-c(c(1.84,49.1),c(1.83,49.2),c(1.84,49.1))
iso<-mapboxapi::mb_isochrone(dt,
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
dt<-c(c(1.84,49.1),c(1.83,49.2),c(1.84,49.1))
dt<-data.frame(c(1.84,49.1),c(1.83,49.2),c(1.84,49.1))
iso<-mapboxapi::mb_isochrone(dt,
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
t(dt)
dt<-t(dt)
dt<-data.frame(c(1.84,49.1),c(1.83,49.2),c(1.84,49.1))
dt<-t(dt)
iso<-mapboxapi::mb_isochrone(dt,
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
dt<-c(c(1.84,49.1),c(1.83,49.2),c(1.84,49.1))
dt<-t(dt)
iso<-mapboxapi::mb_isochrone(dt,
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
iso<-mapboxapi::mb_isochrone(c("Tour eiffel", "Arc de Triomphe"),
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
iso<-mapboxapi::mb_isochrone(c("Arc de Triomphe"),
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
mapdeck(style = mapdeck_style("light")) %>%
add_polygon(
data = iso,
fill_colour = "time",
fill_opacity = 0.5,
legend = TRUE
)
iso<-mapboxapi::mb_isochrone(loc[1,],
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
iso<-mapboxapi::mb_isochrone(loc[1:5,],
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
iso<-mapboxapi::mb_isochrone(loc[i,],
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
for (i in 1:5) {
iso<-mapboxapi::mb_isochrone(loc[i,],
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
}
plot(iso)
for (i in 1:5) {
iso<-mapboxapi::mb_isochrone(loc[i,],
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
list(iso = iso, factPal = colorFactor(rev(heat.colors(12)), iso$time))
}
for (i in 1:5) {
iso<-mapboxapi::mb_isochrone(loc[i,],
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
list(iso = iso)
}
plot(iso)
mapdeck(style = mapdeck_style("light")) %>%
add_polygon(
data = iso,
fill_colour = "time",
fill_opacity = 0.5,
legend = TRUE
)
for (i in 1:5) {
locc$iso[i]<-mapboxapi::mb_isochrone(loc[i,],
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
list(iso = iso)
}
locc<-data.frame(c(1,2,3,4,5))
for (i in 1:5) {
locc$iso[i]<-mapboxapi::mb_isochrone(loc[i,],
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
list(iso = iso)
}
locc<-data.frame(c(1,2,3,4,5),c(1,2,3,4,5),c(1,2,3,4,5),c(1,2,3,4,5),c(1,2,3,4,5))
for (i in 1:5) {
locc$iso[i]<-mapboxapi::mb_isochrone(loc[i,],
profile = "driving",
time = c(5, 10, 15),
access_token = 'pk.eyJ1IjoiamFtZXNpdGhlYSIsImEiOiJjbG93b2FiaXEwMnVpMmpxYWYzYjBvOTVuIn0.G2rAo0xl14oye9YVz4eBcw',
denoise = 1,
generalize = NULL,
geometry = "polygon",
output = "sf",
keep_color_cols = FALSE,
id_column = NULL
)
list(iso = iso)
}
##AU Locaux non résidentiels
res <- httr::GET(url = "https://data.statistiques.developpement-durable.gouv.fr/dido/api/v1/datafiles/f8f0700f-806c-40a7-83b1-f21cf507e7c4/csv?withColumnName=true&withColumnDescription=false&withColumnUnit=false",progress())
library(httr)
##AU Locaux non résidentiels
res <- httr::GET(url = "https://data.statistiques.developpement-durable.gouv.fr/dido/api/v1/datafiles/f8f0700f-806c-40a7-83b1-f21cf507e7c4/csv?withColumnName=true&withColumnDescription=false&withColumnUnit=false",progress())
writeBin(content(res, "raw"), "Sit@del2/1. Données d'origine/LNR.csv")
writeBin(content(res, "raw"), "Sit@del2/1. Données d'origine/LNR.csv")
remotes::install_github("antuki/COGugaison")
remotes::install_github("antuki/COGugaison")
library(COGugaison)
remotes::install_github("antuki/COGugaison",force = T)
detach(COGugaison)
detach("COGugaison")
remotes::install_github("antuki/COGugaison")
remotes::install_github("antuki/COGugaison", force = T)
install.packages("insee")
get_last_release()
insee::get_last_release()
df<-as.data.frame(insee::get_last_release())
View(df)
df<-as.data.frame(insee::get_dataset_list())
install.packages("chatgpt")
setwd("~/")
setwd("C:\Users\james\Ithea Dropbox\Ithea Admin\4. Développement_Outils\31. Econométrie-ML-Scraping-Automatisation\7. Cartographie\QPV\qpv.R")
setwd("C:/Users/james/Ithea Dropbox/Ithea Admin/4. Développement_Outils/31. Econométrie-ML-Scraping-Automatisation/7. Cartographie/QPV/qpv.R")
w <- read.delim(file = "C:\Users\james\Downloads\PS_LibreAcces_202405060914\PS_LibreAcces_Personne_activite_202405060811.txt")
w <- read.delim(file = "C:/Users/james/Downloads/PS_LibreAcces_202405060914/PS_LibreAcces_Personne_activite_202405060811.txt")
w <- read.delim(file = "C:/Users/james/Downloads/PS_LibreAcces_202405060914/PS_LibreAcces_Personne_activite_202405060811.txt",
sep = ";")
w <- read.delim(file = "C:/Users/james/Downloads/PS_LibreAcces_202405060914/PS_LibreAcces_Personne_activite_202405060811.txt",
sep = ",")
View(w)
w <- read.delim(file = "C:/Users/james/Downloads/PS_LibreAcces_202405060914/PS_LibreAcces_Personne_activite_202405060811.txt",
sep = "|")
library(magrittr)
library(dplyr)
library(tidyr)
ped <- w %>%
filter(Code.profession == 80)
inf <- w %>%
filter(Code.profession == 60)
psychologue <- w %>%
filter(Code.profession == 93)
unique(as.factor(w$Libellé.profession))
kiné <- w %>%
filter(Code.profession == 70)
généraliste <- w %>%
filter(Code.profession == 10)
testDavid <- w[1:100000,]
write.xlsx(testDavid,"C:/Users/james/Downloads/annuaireSante.xlsx)
write.xlsx(testDavid,"C:/Users/james/Downloads/annuaireSante.xlsx")
xlsx::write.xlsx(testDavid,"C:/Users/james/Downloads/annuaireSante.xlsx")
writexl::write.xlsx(testDavid,"C:/Users/james/Downloads/annuaireSante.xlsx")
openxlsx::write.xlsx(testDavid,"C:/Users/james/Downloads/annuaireSante.xlsx")
View(testDavid)
unc <- w %>%
filter(Libellé.Voie..coord..structure. != "")
unc <- w %>%
filter(Libellé.Voie..coord..structure. != "") %>%
filter(Code.profession == 70)
uncpsy <- w %>%
filter(Libellé.Voie..coord..structure. != "") %>%
filter(Code.profession == 93) #90% des kiné
uncinf <- w %>%
filter(Libellé.Voie..coord..structure. != "") %>%
filter(Code.profession == 60) #30% des psy
uncped <- w %>%
filter(Libellé.Voie..coord..structure. != "") %>%
filter(Code.profession == 80) #30% des psy
library(rvest)
library(dplyr)
# Fonction pour extraire les informations d'une page donnée
scrape_page <- function(page_number) {
url <- paste0("https://www.villesamiesdesaines-rf.fr/membres/page:", page_number)
page <- read_html(url)
# Extraire les données
pays <- page %>% html_nodes(".membres-recherche-article-pays") %>% html_text()
titre <- page %>% html_nodes(".membres-recherche-titre-article") %>% html_text()
date_adhesion <- page %>% html_nodes(".membres-recherche-adhesion") %>% html_text()
data <- data.frame(
Pays = pays,
Titre = titre,
DateAdhesion = gsub("Adhésion\\s*<br>\\s*", "", date_adhesion)
)
return(data)
}
# Lancer le scraping pour les pages 1 à 16
resultat <- lapply(1:16, scrape_page) %>% bind_rows()
View(resultat)
openxlsx::write.xlsx(resultat, file = "C:/Users/james/Downloads/villesAmiesDesAines.xlsx")
library(rvest)
library(dplyr)
# Fonction pour extraire les informations d'une page donnée
scrape_page <- function(page_number) {
url <- paste0("https://www.villesamiesdesaines-rf.fr/membres/page:", page_number)
page <- read_html(url)
# Extraire les données
pays <- page %>% html_nodes(".membres-recherche-article-pays") %>% html_text(trim = TRUE)
titre <- page %>% html_nodes(".membres-recherche-titre-article") %>% html_text(trim = TRUE)
date_adhesion <- page %>% html_nodes(".membres-recherche-adhesion") %>% html_text() %>% gsub("Adhésion\\s*<br>\\s*", "", .)
label_text <- page %>% html_nodes(".membres-recherche-ville-role") %>% html_text(trim = TRUE)
# Ajouter une condition pour extraire le texte si "AMI DES AÎNÉS" est mentionné
label_text <- ifelse(grepl("AMI DES AÎNÉS", label_text, ignore.case = TRUE), label_text, NA)
data <- data.frame(
Pays = pays,
Titre = titre,
DateAdhesion = date_adhesion,
LabelAmisDesAines = label_text
)
return(data)
}
# Lancer le scraping pour les pages 1 à 16
resultat <- lapply(1:16, scrape_page) %>% bind_rows()
openxlsx::write.xlsx(resultat, file = "C:/Users/james/Downloads/villesAmiesDesAines_VADA.xlsx")
# Charger les bibliothèques nécessaires
library(officer)
library(stringr)
# Spécifier le chemin du dossier contenant les fichiers PowerPoint
chemin_dossier_principal <- "test_replace"
# Lister tous les fichiers PPTX dans les sous-dossiers du dossier principal
fichiers_pptx <- list.files(chemin_dossier_principal, pattern = "\\.pptx$", full.names = TRUE, recursive = TRUE)
# Fonction pour supprimer les zones de texte contenant <xLEG10>
supprimer_zone_texte <- function(pptx) {
# Parcourir chaque diapositive
for (i in seq_len(length(slide_summary(pptx)))) {
# Aller à la diapositive i
pptx <- on_slide(pptx, index = i)
# Extraire le contenu de la diapositive
slide_content <- pptx %>% slide_summary()
# Parcourir chaque élément de la diapositive
for (j in seq_len(nrow(slide_content))) {
# Vérifier si l'élément contient le texte <xLEG10>
if (!is.na(slide_content$text[j]) && str_detect(slide_content$text[j], "<xLEG10>")) {
# Supprimer la zone de texte contenant <xLEG10>
pptx <- ph_remove(pptx, id = slide_content$ph_label[j])
}
}
}
return(pptx)
}
setwd("C:/Users/james/Downloads/terribot")
reticulate::repl_python()
